<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Sakila : ì£¼ì†Œ ê´€ë¦¬</title>
	<!-- ìŠ¤íƒ€ì¼ì‹œíŠ¸ css íŒŒì¼ import -->
	<link rel="stylesheet" href="../style/hi.css">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">
	<script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
</head>
<body>
	<div class="columns" style="margin:0; height: 100%">
		{{x}}
		<!-- ë©”ë‰´ -->
		<div class="column is-2 notification card is-peachy" style="margin:0;">
			<section class="section">
			    <div id="menu"></div>
			</section>
		</div>
		<!-- ë‚´ìš© -->
		<div class="column">
			 <nav class="breadcrumb notification is-lighter-peachy" aria-label="breadcrumbs">
			  <ul>
			    <li><a href="#">ADDRESS</a></li>
			    <li class="is-active"><a href="#" aria-current="page">ì£¼ì†Œê´€ë¦¬</a></li>
			  </ul>
			 </nav>
			 
			 <section class="is-content">
		   	  <h1 class="title is-4 is-spaced">ğŸ  ì£¼ì†Œ ê´€ë¦¬</h1>
			  <h1 class="subtitle is-6">êµ­ê°€/ë„ì‹œ ì„ íƒ ê²€ìƒ‰</h1>
				<!-- êµ­ê°€ ì„ íƒ -->
				<div class="select">
					<select id="countryList">
						<option v-for="item in country">{{ item.countryName }}</option>
					</select>
				</div>
				<!-- selecting city -->
				<div class="select" id="citys" style="display:none;">
					<select id="cityList" v-model="cityName">
						<option v-for="item in city">{{ item }}</option>
					</select>
				</div>	
				<button type="button" class="button" @click="selectAddress"> ê²€ìƒ‰ </button>
			  <hr>
			  <!-- í…Œì´ë¸” ì •ë³´ -->
			  <h1 class="title is-5 has-text-centered is-danger">ê²€ìƒ‰ ê²°ê³¼</h1>
			  <table class="table is-hoverable is-bordered is-fullwidth">
					<thead>

						<tr>
							<th class="has-text-centered" width="5%">ë²ˆí˜¸</th>
							<th class="has-text-centered">ì£¼ì†Œ</th>
							<th class="has-text-centered">ìƒì„¸ì£¼ì†Œ</th>
							<th class="has-text-centered" width="5%">ì§€</th>
							<th class="has-text-centered" width="10%">ì§€ì—­</th>
							<th class="has-text-centered" width="8%">ìš°í¸ë²ˆí˜¸</th>
							<th class="has-text-centered" width="8%">ì „í™” ë²ˆí˜¸</th>
							<th class="has-text-centered" width="13%">ë§ˆì§€ë§‰ ìˆ˜ì •</th>
						</tr>
					</thead>
					<tbody>
						<tr v-for="json in item"></tr>
							<td>{{item.addressId}}</td>
							<td>{{item.address}}</td>
							<td>{{item.address2}}</td>
							<td>{{item.city.cityId}}</td>
							<td>{{item.district}}</td>
							<td>{{item.postalCode}}</td>
							<td>{{item.phone}}</td>
							<td>{{item.lastUpdate}}</td>
						</tr>
					</tbody>

				</table>
				
				<button type="button" class="button" @click="preBtn">ì´ì „</button>
				<button type="button" class="button" @click="nextBtn">ë‹¤ìŒ</button>
			<hr>
		  </section>
		  <div id="foot"></div>
		</div><!-- ë‚´ìš© ë -->
	</div><!-- columns ë -->
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="../js/sakilaCRM.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script>
var currentPage = 1;
var lastPage;

var vm = new Vue({
	el: ".columns",
	data: {
		x:1,
		json:[{}],
		cityName : "",
		country : [{}],
		city : [{}],
	},
	mounted() {
		console.log("getting Info! ");
		$.ajax({
			url:"/sakila/address/SelectCountryListAll", 
			method: "POST",
			success : function(json){
				console.log("ì•„íœ´ í˜ë“¤")
			}
		});
	},
	methods: {
		selectAddress : function(){
			
			console.log("cityName: ", this.cityName);
			if(this.cityName === ""){
				alert("ë„ì‹œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”");
				return;
			}
			
			
		},
		
		nextBtn : function(){
			this.x = 10;
			if(currentPage >= lastPage){
				alert("ë§ˆì§€ë§‰ í˜ì´ì§€ì…ë‹ˆë‹¤.")
				return;
			}
			
			currentPage ++;
			getAddressList();
		},
		prevBtn : function(){
			if(currentPage <= 1){
				alert("ì´ì „ í˜ì´ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.")
				return;
			}
			
			currentPage --;
			getAddressList();
		},
	},
});

function getAddressList(){
	console.log("get getAddressList")
	
		
}






/* 
	
	// country ëª©ë¡ ì¶œë ¥
	$.ajax({
		url:"/sakila/address/SelectCountryListAll", 
		method: "POST",
		success : function(json){
				$(json).each(function(index, item){
				temp="<option value='";
				temp+=item.countryId;
				temp+="'>";
				temp+=item.country;
				temp+="</option>";
				$("#countryList").append(temp);
			});
		}
	});	
	
	// ë‚˜ë¼ ì„ íƒì‹œ ë‚˜ë¼ ë²ˆí˜¸ ì¶œë ¥ & city list select
	$("#countryList").change(function(){
		console.log($("#countryList").val())
		// when country selected -> ë„ì‹œ ëª©ë¡ ì¶œë ¥
		$.ajax({
			url:"/sakila/address/SelectCityListByCountry", 
			method: "POST",
			data : {"countryId" : $("#countryList").val()},
			success : function(json){
				$(json).each(function(index, item){
					temp="<option value='";
					temp+=item.cityId;
					temp+="'>";
					temp+=item.city;
					temp+="</option>";
					$("#cityList").append(temp);
				});
				$("#citys").fadeIn();
			},
			error:function(){
				alert("ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨");
				console.log(json)
			}
		});
	});
	
	
	
	
	//ì´ì „ ë²„íŠ¼
	$("#preBtn").click(function(){
		if(currentPage === 1){
			alert(" í˜„ì¬ 1í˜ì´ì§€ ì…ë‹ˆë‹¤. ë” ì´ìƒ ì•ìœ¼ë¡œ ê°ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
			return;
		}
		currentPage -=1;
		console.log(currentPage);
		
		$("#list").empty();
		// ëª©ë¡ ì¶œë ¥
		getList();	
	});
	
	// ë‹¤ìŒ ë²„íŠ¼
	$("#nextBtn").click(function(){
		
		
		let lastPage = Math.ceil(count / 10);
		if(currentPage == lastPage){
			alert(" í˜„ì¬ ë§ˆì§€ë§‰í˜ì´ì§€ ì…ë‹ˆë‹¤. ë” ì´ìƒ ë‹¤ìŒìœ¼ë¡œ ê°ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
			return;
		}
		
		currentPage +=1;
		console.log(currentPage);
		
		$("#list").empty();
		// ëª©ë¡ ì¶œë ¥
		getList();
		
	});
	
	$("#selectAddress").click(function(){
		console.log("selectAddress ë²„íŠ¼ clicked"); 
		currentPage = 1;
		if($("#cityList").val() === ""){
			alert("ë„ì‹œë¥¼ ì§€ì •í•´ì£¼ì„¸ìš” !");
		}else{					
			$.ajax({
				url: "/sakila/address/SelectAddressListByCity",
				method: "POST", 
				data: {currentPage : currentPage, cityId: $("#cityList").val()},
				success: function(json){
					console.log(json);
					console.log("cityList: ",$('#cityList').val());
					//ë¹„ìš°ê³ 
					$("#list").empty();				
					$(json).each(function(index, item){
						
						$("#list").append(html);
					})					
				}
			});	// ajax end		
		}//else end
	});//click end
	  */
	
	
	
</script>
</html>